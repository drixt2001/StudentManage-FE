<div class="container">
  <h3 style="margin-bottom: 1rem" nz-typography>Thống kê</h3>

  <div class="filter-bar">
    <div class="filter-child">
      <nz-select nzShowSearch nzAllowClear nzPlaceHolder="Chọn Tiêu Chí">
        <nz-option
          [nzLabel]="'Lượng người đi muộn nhiều nhất theo học phần'"
          [nzValue]="'max1'"
        ></nz-option>
        <nz-option
          [nzLabel]="'Lượng người vắng nhiều nhất theo học phần'"
          [nzValue]="'max2'"
        ></nz-option>
        <nz-option
          [nzLabel]="'Lượng người đi muộn nhiều nhất theo lớp hệ thống'"
          [nzValue]="'max3'"
        ></nz-option>
        <nz-option
          [nzLabel]="'Lượng người vắng nhiều nhất theo lớp hệ thống'"
          [nzValue]="'max4'"
        ></nz-option>
        <nz-option
          [nzLabel]="'Lượng người đi muộn nhiều nhất toàn trường'"
          [nzValue]="'max5'"
        ></nz-option>
        <nz-option
          [nzLabel]="'Lượng người vắng nhiều nhất toàn trường'"
          [nzValue]="'max6'"
        ></nz-option>
      </nz-select>
    </div>

    <!-- Hoc ky -->
    <div class="filter-child">
      <nz-select
        nzShowSearch
        nzAllowClear
        nzPlaceHolder="Chọn khoảng thời gian"
      >
        <nz-option [nzLabel]="'Hôm nay'" [nzValue]="'today'"></nz-option>
        <nz-option [nzLabel]="'Tuần này'" [nzValue]="'week'"></nz-option>
        <nz-option [nzLabel]="'Tháng này'" [nzValue]="'month'"></nz-option>
        <nz-option [nzLabel]="'Học kỳ nay'" [nzValue]="'semester'"></nz-option>
        <nz-option
          [nzLabel]="'Tùy chọn khoảng'"
          [nzValue]="'semester'"
        ></nz-option>
      </nz-select>
    </div>
    <!-- Hoc ky -->

    <!-- Button -->
    <button (click)="search()" nz-button nzType="primary">
      <span nz-icon nzType="container" nzTheme="outline"></span>
      Thống Kê
    </button>

    <button class="button add" (click)="export()" nz-button nzType="primary">
      <span nz-icon nzType="file-excel" nzTheme="outline"></span>
      Xuất Excel
    </button>

    <!-- Button -->
  </div>
  <div class="table container">
    <nz-table id="tablez" nzBordered #Table [nzData]="listOfData">
      <thead>
        <tr>
          <th>STT</th>
          <th>Mã</th>
          <th>Họ Và Tên</th>
          <th>Lớp</th>
          <th>Học Phần Tham Gia</th>
          <th>Số Buổi Vắng</th>
          <th>Trong Thời Gian</th>
          <th>Hành Động</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of Table.data">
          <td>{{ Table.data.indexOf(data) + 1 }}</td>
          <td>{{ data.id }}</td>
          <td>{{ data.name }}</td>
          <td>{{ data.class_name }}</td>
          <td>{{ data.module }}</td>
          <td>{{ data.leave }}</td>
          <td>{{ data.rangeTime }}</td>
          <td>
            <div style="display: flex" class="flex">
              <button [routerLink]="[data.id]" nz-button nzType="default">
                Xem Chi Tiết
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </nz-table>
  </div>
</div>

<div class="container">
  <h3 style="margin-bottom: 1rem" nz-typography>Báo cáo</h3>

  <div class="filter-bar">
    <div class="filter-child">
      <nz-select nzShowSearch nzAllowClear nzPlaceHolder="Chọn Tiêu Chí">
        <nz-option
          [nzLabel]="'Lượng người đi muộn nhiều nhất theo học phần'"
          [nzValue]="'max1'"
        ></nz-option>
        <nz-option
          [nzLabel]="'Lượng người vắng nhiều nhất theo học phần'"
          [nzValue]="'max2'"
        ></nz-option>
        <nz-option
          [nzLabel]="'Lượng người đi muộn nhiều nhất theo lớp hệ thống'"
          [nzValue]="'max3'"
        ></nz-option>
        <nz-option
          [nzLabel]="'Lượng người vắng nhiều nhất theo lớp hệ thống'"
          [nzValue]="'max4'"
        ></nz-option>
        <nz-option
          [nzLabel]="'Số lần đi muộn nhiều nhất toàn trường'"
          [nzValue]="'max5'"
        ></nz-option>
        <nz-option
          [nzLabel]="'Lượng người vắng nhiều nhất toàn trường'"
          [nzValue]="'max6'"
        ></nz-option>
      </nz-select>
    </div>

    <div class="filter-child">
      <nz-select nzShowSearch nzAllowClear nzPlaceHolder="Theo Lớp">
        <nz-option [nzLabel]="'Gộp theo Lớp'" [nzValue]="'max1'"></nz-option>
        <nz-option [nzLabel]="'Gộp theo Khoa'" [nzValue]="'max2'"></nz-option>
        <nz-option [nzLabel]="'Gộp Học Phần'" [nzValue]="'max3'"></nz-option>
      </nz-select>
    </div>

    <!-- Hoc ky -->
    <div class="filter-child">
      <nz-select
        nzShowSearch
        nzAllowClear
        nzPlaceHolder="Chọn khoảng thời gian"
      >
        <nz-option [nzLabel]="'Hôm nay'" [nzValue]="'today'"></nz-option>
        <nz-option [nzLabel]="'Tuần này'" [nzValue]="'week'"></nz-option>
        <nz-option [nzLabel]="'Tháng này'" [nzValue]="'month'"></nz-option>
        <nz-option [nzLabel]="'Học kỳ nay'" [nzValue]="'semester'"></nz-option>
      </nz-select>
    </div>
    <!-- Hoc ky -->

    <!-- Button -->
    <button (click)="search()" nz-button nzType="primary">
      <span nz-icon nzType="line-chart" nzTheme="outline"></span>
      Báo cáo
    </button>

    <button class="button add" (click)="export()" nz-button nzType="primary">
      <span nz-icon nzType="file-pdf" nzTheme="outline"></span>
      Xuất PDF
    </button>

    <!-- Button -->
  </div>
  <div class="chart container">
    <div class="chartOnline">
      <canvas id="countDelayChart"></canvas>
    </div>
    <div class="chartOnline">
      <canvas id="countDelayChart2"></canvas>
    </div>
  </div>
</div>

<nz-modal
  [nzFooter]="modalFooter"
  [(nzVisible)]="isVisible"
  nzTitle="Tạo Học Phần"
  (nzOnCancel)="handleCancel()"
  (nzOnOk)="handleOk()"
>
  <ng-container *nzModalContent>
    <form [formGroup]="moduleForm" nz-form>
      <nz-form-item>
        <nz-form-label [nzSpan]="6">Mã học phần</nz-form-label>
        <nz-form-control [nzSpan]="14">
          <input formControlName="sid" nz-input name="full_name" />
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="6">Tên học phần</nz-form-label>
        <nz-form-control [nzSpan]="14">
          <input formControlName="name" nz-input name="full_name" />
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="6">Học Kỳ</nz-form-label>
        <nz-form-control [nzSpan]="14">
          <nz-select
            formControlName="period_id"
            nzShowSearch
            nzAllowClear
            nzPlaceHolder="Học Kỳ"
          >
            <nz-option
              *ngFor="let period of periodData"
              [nzLabel]="period.full_name"
              [nzValue]="period.id"
            ></nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="6">Khoa</nz-form-label>
        <nz-form-control [nzSpan]="14">
          <nz-select
            nzShowSearch
            nzAllowClear
            nzPlaceHolder="Khoa"
            formControlName="department_id"
            (ngModelChange)="changeDepartment()"
          >
            <nz-option
              *ngFor="let department of departmentData"
              [nzLabel]="department.name"
              [nzValue]="department.id"
            ></nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="6">Giảng Viên</nz-form-label>
        <nz-form-control [nzSpan]="14">
          <nz-select
            formControlName="teacher_id"
            nzShowSearch
            nzAllowClear
            nzPlaceHolder="Giảng viên giảng dạy"
          >
            <nz-option
              *ngFor="let teacher of teacherData"
              [nzLabel]="teacher.name"
              [nzValue]="teacher.teacher_id"
            ></nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="6">Số TC</nz-form-label>
        <nz-form-control [nzSpan]="14">
          <nz-select
            formControlName="credit"
            nzShowSearch
            nzAllowClear
            nzPlaceHolder="Số Tín Chỉ"
          >
            <nz-option nzLabel="1" [nzValue]="1"></nz-option>
            <nz-option nzLabel="2" [nzValue]="2"></nz-option>
            <nz-option nzLabel="3" [nzValue]="3"></nz-option>
            <nz-option nzLabel="4" [nzValue]="4"></nz-option>
            <nz-option nzLabel="7" [nzValue]="7"></nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>
    </form>
  </ng-container>

  <ng-template #modalFooter>
    <button (click)="handleCancel()" nz-button nzType="default">Hủy</button>
    <button nz-button nzType="primary" (click)="handleOk()">
      Tạo Học Phần
    </button>
  </ng-template>
</nz-modal>
